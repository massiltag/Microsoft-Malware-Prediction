'''
    Microsoft Malware Prediction with XGBoost Decision Tree Algorithm
    Massil TAGUEMOUT
'''
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import json, datetime as dt

from sklearn.model_selection import train_test_split as tts
from xgboost.sklearn import XGBClassifier

print("Microsoft Malware Prediction using a Decision Tree Algorithm (XGBoost)")
d1 = dt.datetime.now()
print("Data processing started at", "%02d:%02d" % (d1.hour, d1.minute))

# Data loading
with open('./data/datatypes.json') as file:
    dtype = json.load(file)
df = pd.read_csv('../dcsv/microsoft-malware.csv', dtype=dtype)

# Dropping categorical
df = df.iloc[:20000,:]
binary = []
categorical = []
numerical = []

for key, value in dtype.items():
    if value in ['int8']:
        binary.append(key)
    if value in ['int16','category']:
        categorical.append(key)
    else:
        numerical.append(key)

categorical.remove('MachineIdentifier') # Déjà enlevé par iloc
df = df.drop(columns=list(categorical))